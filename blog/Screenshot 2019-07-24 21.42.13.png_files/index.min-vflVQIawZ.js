define(["require","exports","tslib","react","classnames","spectrum_comments/annotation_rectangle_creation_layer/resize_handles","spectrum_comments/annotation_rectangle_creation_layer/utilities","spectrum_comments/raf_style"],function(e,t,n,r,o,a,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={clickThreshold:i.Threshold.NotExceeded,internalPlacement:null},t.ref=null,t.rectangleRef=null,t.onDeltaStart=function(e,r,o){if(void 0===o&&(o=!1),i.pertainsToLeftClick(e)){var a=e.clientX,s=e.clientY,c=t.rectangleRef,l={x:a,y:s},u=o?n.__assign({},l,{width:0,height:0}):c&&i.clientRectToRectangle(c.getBoundingClientRect());u&&(t.attachListeners(),t.props.onRectChangeStart(o),t.setState({resizeDragMeta:{originPoint:l,deltaMovement:r,originRect:u}}))}},t.onDeltaChange=function(e){var n=t.state,r=n.resizeDragMeta,o=n.clickThreshold;if(r&&t.rectCanChange(e)){var a=e.clientX,s=e.clientY,c=r.originPoint,l=r.deltaMovement,u=r.originRect,h=i.calculateDelta(c,{x:a,y:s});o===i.Threshold.NotExceeded?(t.setState({clickThreshold:i.Threshold.Exceeded}),t.props.onRectChange(i.applyDelta(u,h,l),l,!0)):t.props.onRectChange(i.applyDelta(u,h,l),l)}},t.onDeltaEnd=function(){t.state.clickThreshold===i.Threshold.NotExceeded&&t.props.clearPlacement(),t.removeListeners(),t.props.onRectChangeEnd(),t.setState({resizeDragMeta:void 0,clickThreshold:i.Threshold.Ignore})},t.onRectangleMouseDown=function(e){e.currentTarget===e.target&&t.onDeltaStart(e,a.DragInitiator)},t.buildResizer=function(e){return r.createElement("div",{style:a.resizeStyles[e],key:e,className:a.resizeClasses[e],onMouseDown:function(n){return t.onDeltaStart(n,e)}})},t.setRef=function(e){t.ref=e},t.setRectangleRef=function(e){t.rectangleRef=e},t.onLayerMouseDown=function(e){var n=e.target,r=i.isOnText(e)||i.isOnLink(e),o=t.rectangleRef&&t.rectangleRef.contains(n);r||o||(t.setState({clickThreshold:i.Threshold.NotExceeded}),t.onDeltaStart(e,a.Corner.BottomRight,!0))},t}return n.__extends(t,e),Object.defineProperty(t.prototype,"className",{get:function(){return o({"sc-annotation-rectangle-creation-layer":!0,"sc-annotation-rectangle-creation-layer__is-creating":!!this.state.resizeDragMeta})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"annotationClassName",{get:function(){return o("sc-annotation-rectangle-creation-draft")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){var e=this.props.placement;if(e){return{transform:"translate("+e.x+"px, "+e.y+"px)",width:e.width,height:e.height}}},enumerable:!0,configurable:!0}),t.prototype.attachListeners=function(){document.addEventListener("mousemove",this.onDeltaChange,!0),document.addEventListener("mouseup",this.onDeltaEnd)},t.prototype.removeListeners=function(){document.removeEventListener("mousemove",this.onDeltaChange),document.removeEventListener("mouseup",this.onDeltaEnd)},t.prototype.rectCanChange=function(e){var t=this.state,n=t.resizeDragMeta;return t.clickThreshold!==i.Threshold.NotExceeded||n&&i.hasExceededThreshold(n.originPoint,e)},t.prototype.maybeRenderAnnotationDraft=function(){var e=this;if(this.props.placement)return r.createElement(s.RafStyle,{style:this.style},function(t){return r.createElement("div",{ref:e.setRectangleRef,style:t,className:e.annotationClassName,onMouseDown:e.onRectangleMouseDown},[a.Edge.Top,a.Edge.Left,a.Edge.Right,a.Edge.Bottom,a.Corner.TopLeft,a.Corner.TopRight,a.Corner.BottomLeft,a.Corner.BottomRight].map(e.buildResizer))})},t.prototype.render=function(){var e=this,t=e.className,n=e.setRef,o=e.onLayerMouseDown;return r.createElement("div",{ref:n,className:t,onMouseDown:o},this.props.children,this.maybeRenderAnnotationDraft())},t})(r.PureComponent);t.AnnotationRectangleCreationLayer=c});
//# sourceMappingURL=index.min.js-vflIaV9fP.map